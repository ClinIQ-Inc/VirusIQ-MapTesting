<!DOCTYPE html>
<html>

<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" type="text/css" href="TestingMapStyle.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
	   integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
	   crossorigin=""/>
	   
	<style>
	#leafmap { height: 400px; width:500px}
	</style>
	<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript">
		
	</script>
	<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/css/select2.min.css" rel="stylesheet" />
	<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>
	<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
	   integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
	   crossorigin=""></script>
   
</head>


<body class="slds-scope">
	
	<h3 style="text-align: center;margin-bottom: 30px;margin-top: 20px;display: block;">VirusIQ Lab Locations Prototype</h3>

	<!--
	<div class="list-header">
		<form enctype="multipart/form-data">
			<div id= "inner_div">
			  
				<input id="upload" type=file  name="files[]" class="form-control-file">
				<br/>
			</div>
		</form>

		<div class ="float-column">
			<strong style="cursor:default;">Testing Services</strong>
			<div>
				<select id ="services" style="width: 200px;" tabindex="-1" class = "select2-hidden-accessible" aria-hidden = "true">
					<option value="ALL" selected>All Services</option>
    				<option value="At-home Test">At-home Test</option>
    				<option value="Drive-in">Full Service: Drive-in, Walk-in, At-home Sample</option>
    				<option value="Testing Lab (B2B)">Testing Lab (B2B)</option>
  				</select>
  			</div>
  		</div>
  		<div class="float-column">
			<strong style="cursor:default;">Test Types</strong>
			<div>
  				<select id="TestTypes" style="width: 200px;" tabindex="-1" class = "select2-hidden-accessible" aria-hidden = "true">
  					<option value="ALL" selected>All Test Types</option>
    				<option value="Antigen Tests">Antigen Tests</option>
    				<option value="Serology Tests">Serology Tests</option>
    				<option value="PCR Molecular Tests">PCR Molecular Tests</option>
  				</select>
  			</div>
  		</div>
  		<div class="float-column">
			<strong style="cursor:default; justify-content:center;">Contracting Entities</strong>
			<div>
   				<select id ="ContractingEntities" style="width: 200px;" tabindex="-1" class = "select2-hidden-accessible" aria-hidden = "true">
  					<option value="ALL" selected>All Contracting Entities</option>
    				<option value="Antigen Tests">Congregate Living Facilities</option>
    				<option value="Serology Tests">Long Term Care Facilities</option>
    				<option value="Private Employers">Private Employers</option>
    				<option value="Outpatient Practices">Outpatient Practices</option>
    				<option value="Private Employers">Private Employers</option>
    				<option value="Health Plans">Health Plans</option>
    				<option value="Hospitals">Hospitals</option>
    				<option value="SFCs">SFCs</option>
  				</select>
  			</div>
  		</div>
  		<div class="float-column">
			<strong style="cursor:default; justify-content:center;">Payors Billed</strong>
			<div>
   				<select id="Payors" style="width: 200px;" tabindex="-1" class = "select2-hidden-accessible" aria-hidden = "true">
  					<option value="ALL" selected>All Payors</option>
    				<option value="Aetna Payors">Aetna Payors</option>
    				<option value="Centene Payors">Anthem Blue Cross Payors</option>
    				<option value="Cigna Payors">Blue Shield ofCalifornia Payors</option>
    				<option value="LA Care Payors">Centene Payors</option>
    				<option value="Medi-Cal Payors">Cigna Payors</option>
    				<option value="Medicare FFS Payors">Kaiser Permanente Payors</option>
    				<option value="Molina Healthcare Payors">LA Care Payors</option>
    				<option value="Anthem Blue Cross Payors"> Medi-Cal Payors</option>
    				<option value="Medicare FFS Payors">Medicare FFS Payors</option>
    				<option value="Blue Shield ofCalifornia Payors"> Molina Healthcare Payors</option>
    				<option value="Kaiser Permanente Payors">United Healthcare</option>
  				</select>
  			</div>
  		</div>
		<a class="btn btn-primary mb-2" href="https://virusiq.health/diagnostics-vendors" role="button" target="_blank">Register New Lab</a>
	</div>-->
	
	<!--<div style="width:400px; height:400px;">
	
		<iframe src="https://www.cssscript.com/demo/resizable-draggable-dialog/" width=400 height=400 ></iframe>
	
	</div>-->
	
	<div class="container" >
		
		<br/>
	
		<div class="row">
		
			<div class="col-md-1"></div>
			<div class="col-md-10">
				<div class="row">
					<form class="form-inline col" >
					  <input class="form-control col-md-10" type="search" placeholder="Search" aria-label="Search">
					  <button class="btn btn-outline-success col-md-2" type="submit">Search</button>
					</form>
				</div>
			</div>
			
		
		</div>
		
		
		
		<br/>
	
		<div class="row" style="padding:5px;" >
		
			<div class="col-md-1"></div>
			
			<div class="col-md-5 bg-warning" id="lab-list" style="padding:10px;">
				<br/>
				<div class="spinner-border m-5" role="status">
				  <span class="sr-only">Loading...</span>
				</div>
				
			
			</div>
			
			<div class="col-md=5" style="padding:5px;">
			
				<div id="leafmap"></div>
			
			</div>
		
		</div>
	
		
		
	</div>
	
	<!--<div id="map"></div>-->

	

	
	<!-- <button onclick="myFunction()">Load Map</button> -->

	<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/jszip.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/xlsx.js"></script>
	<script async defer src= "https://maps.googleapis.com/maps/api/js?key=AIzaSyCmsZo6Hn04RnZeMhM-mSfhfPUZNzsR0NE"></script>
		
	
	<script type="text/javascript" src="map_functions.js"> </script>
	
	<script  type="text/javascript" type="text/javascript">
		$(document).ready(function() {
			/**$('#services').select2().on('change',listQ);
			$('#TestTypes').select2().on('change',listQ);
			$('#ContractingEntities').select2().on('change',listQ);
			$('#Payors').select2().on('change',listQ);
			document.getElementById('services').value = 'ALL';
			  document.getElementById('TestTypes').value = 'ALL';
			  document.getElementById('ContractingEntities').value ='ALL';
			  document.getElementById('Payors').value ='ALL';**/
		});
        $('#upload').on('change', fileReader, false);
		function listQ(){
			//window.alert(document.getElementById("ContractingEntities").value);
			load_locations();
		}
	  // document.getElementById("services").addEventListener("change",listQ);
	  
		
		  
		  //vi.map.initialize();
			var map = L.map('leafmap').setView([51.505, -0.09], 13);

			L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
				attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
			}).addTo(map);

			L.marker([51.5, -0.09]).addTo(map)
				.bindPopup('London')
				.openPopup();
			L.marker([52.5, -1]).addTo(map)
				.bindPopup('London')
				.openPopup();
			L.marker([50.5, 1]).addTo(map)
				.bindPopup('London')
				.openPopup();
			
			
			
			
			$.ajax({
			type: "POST",
			url: "https://ncoviq.com:9090/v2/api/getLabs",
			// The key needs to match your method's input parameter (case-sensitive).
			data: JSON.stringify({ "state": "all" }),
			contentType: "application/json; charset=utf-8",
			dataType: "json",
			success: function(data){
				 //{"responseCode":0,"response":{"labData":[{"labId":1,"longitude":"38.26709","latitude":"-121.94","updateDate":"28-Dec-20","sources":"http://www.1carediagnostics.com","country":"USA","state":"CA","county":"Solano","city":"Benicia","coverageAreas":"Bay Area; Northern California","managingOrganization":"1Care Medical Diagnostics","telecom":"laryy.coleman@1carediagnostics.com","phone":"","serviceCapabilities":"Drive-in, Walk-in, At-home Sample","prescription":"","sampleCollectionSupervision":"","typeOfSpecimenCollected":"Nasal Mid turbinate Swab Test; Nasopharyngeal Swab Test","typeOfCovidTest":"AntigenTests; PCR Molecular Tests","dailyCapacity":"501-1000 tests/day","testTurnaround":"Within 24-48 hrs","payorsBilledBy":"Aetna Payors; Anthem Blue Cross Payors; Blue Shield ofCalifornia Payors; Centene Payors; Cigna Payors; Kaiser Permanente Payors; LA Care Payors; Medi-Cal Payors; Medicare FFS Payors; Molina Healthcare Payors; United Healthcare","contractingEntities":"Congregate Living Facilities; Health Plans; Long Term Care Facilities; Outpatient Practices; Private Employers; SFCs","testPerformedByFacility":""},{"labId":2,"longitude":"","latitude":"","updateDate":"","sources":"http://www.aegislabs.com","country":"USA","state":"TN","county":"Davidson","city":"Nashville","coverageAreas":"All","managingOrganization":"Aegis Labs","telecom":"covidtest@aegislabs.com","phone":"615-255-2400","serviceCapabilities":"At-home Sample","prescription":"","sampleCollectionSupervision":"","typeOfSpecimenCollected":"Mid Turbinate Swab; Nasopharyngeal Swab; Oropharyngeal Swab","typeOfCovidTest":"PCR Molecular; Serology PCR","dailyCapacity":">10K tests/day","testTurnaround":"Within 24-48 hrs","payorsBilledBy":"Aetna Payors; Anthem Blue Cross; Blue Shield of California; Centene; Cigna; Kaiser Permanente; LA Care; Medi-Cal; Medicare FFS; Molina Healthcare; United Healthcare","contractingEntities":"Congregate Living Facilities; Health Plans; Long Term Care Facilities; Outpatient Practices; Private Employers; SFCs","testPerformedByFacility":""},{"labId":3,"longitude":"","latitude":"","updateDate":"","sources":"https://www.ambrygen.com/covid","country":"","state":"","county":"Orange","city":"Aliso Viejo","coverageAreas":"","managingOrganization":"AMBRY GENETICS CORPORATION","telecom":"jotten@ambrygen.com","phone":"","serviceCapabilities":"At-home Sample","prescription":"","sampleCollectionSupervision":"","typeOfSpecimenCollected":"Saliva","typeOfCovidTest":"PCR Molecular","dailyCapacity":"5001-10K tests/day","testTurnaround":"Within 24-48 hrs","payorsBilledBy":"Aetna Payors; Anthem Blue Cross; Facility Blue Shield of California; Centene; Cigna; Kaiser Permanente; LA Care; Medi-Cal; Medicare FFS; Molina Healthcare; United Healthcare","contractingEntities":"Congregate Living Facilities Health Plans Long Term Care Facilities Outpatient Practices Private Employers SFCs","testPerformedByFacility":""},{"labId":4,"longitude":"32.71576","latitude":"-117.16382","updateDate":"19-12-2021","sources":"","country":"USA","state":"CA","county":"San Diego","city":"San Diego","coverageAreas":"Southern California","managingOrganization":"ALCALA TESTING & ANALYSIS SERVICES","telecom":"christian.tagwerker@alcalalabs.com","phone":"\"(619) 450-5870 \"","serviceCapabilities":"At-home Test","prescription":"","sampleCollectionSupervision":"","typeOfSpecimenCollected":"Nasal Mid turbinate Swab Test; Nasopharyngeal Swab Test; Oropharyngeal Swab Test; Serum Test","typeOfCovidTest":"Serology Tests; PCR Molecular Tests","dailyCapacity":"","testTurnaround":"Within 24-48 hrs","payorsBilledBy":"Aetna Payors; Anthem Blue Cross Payors; Blue Shield ofCalifornia Payors; Centene Payors; Cigna Payors; Kaiser Permanente Payors; LA Care Payors; Medi-Cal Payors; Medicare FFS Payors; Molina Healthcare Payors; United Healthcare","contractingEntities":"Congregate Living Facilities; Health Plans; Long Term Care Facilities; Outpatient Practices; Private Employers; SFCs","testPerformedByFacility":""},{"labId":5,"longitude":"29.81605","latitude":"-95.23767","updateDate":"","sources":"http://apollomdx.com","country":"USA","state":"CA","county":"Harris","city":"Houston","coverageAreas":"All California","managingOrganization":"ApolloMDx LLC","telecom":"emyleethai@apollomdx.com","phone":"","serviceCapabilities":"Drive-in, Walk-in, At-home Sample","prescription":"","sampleCollectionSupervision":"","typeOfSpecimenCollected":"Nasopharyngeal Swab Test; Oropharyngeal Swab Test; Saliva Test","typeOfCovidTest":"PCR Molecular Tests","dailyCapacity":"2001-5000 tests/day","testTurnaround":"Within 48-72 hrs","payorsBilledBy":"","contractingEntities":"Congregate Living Facilities; Health Plans; Long Term Care Facilities; Outpatient Practices; Private Employers; SFCs","testPerformedByFacility":""},{"labId":6,"longitude":"35.373871","latitude":"-119.019464","updateDate":"","sources":"http://arcpointlabs.com/bakersfield","country":"USA","state":"CA","county":"Kern","city":"Bakersfield","coverageAreas":"Central California","managingOrganization":"arcpoint labs of Bakersfield","telecom":"lelliott@arcpointlabs.com","phone":"","serviceCapabilities":"Drive-in, Walk-in, At-home Sample","prescription":"","sampleCollectionSupervision":"","typeOfSpecimenCollected":"Nasal Mid turbinate Swab Test; Nasopharyngeal Swab Test; Oropharyngeal Swab Test; Saliva Test; Serum Test","typeOfCovidTest":"Antigen Tests","dailyCapacity":"101-500 tests/day","testTurnaround":"Less than 24 hrs","payorsBilledBy":"Kaiser Permanente Payors; Medi-Cal Payors; Medicare FFS","contractingEntities":"Congregate Living Facilities; Health Plans; Long Term Care Facilities; Outpatient Practices; Private Employers; SFCs","testPerformedByFacility":""},{"labId":7,"longitude":"","latitude":"","updateDate":"","sources":"www.arcpointmartinez.com","country":"USA","state":"CA","county":"Martinez","city":"Contra Costa","coverageAreas":"Bay Area Northern California","managingOrganization":"arcpoint labs of Martinez","telecom":"maya@arcpointlabs.com","phone":"","serviceCapabilities":"Drive-in, Walk-in, At-home Sample","prescription":"","sampleCollectionSupervision":"","typeOfSpecimenCollected":"Nasal Mid turbinate Swab Nasopharyngeal Swab Saliva Serum","typeOfCovidTest":"Antigen Serology PCR Molecular","dailyCapacity":"101-500 tests/day","testTurnaround":"Less than 24 hrs","payorsBilledBy":"","contractingEntities":"Congregate Living Facilities Health Plans Long Term Care Facilities Outpatient Practices Private Employers SFCs","testPerformedByFacility":""},{"labId":8,"longitude":"34.05224","latitude":"-118.24334","updateDate":"","sources":"http://www.ashleylab.com","country":"USA","state":"CA","county":"Los Angeles","city":"Los Angeles","coverageAreas":"All California","managingOrganization":"Ashley clinical diagnostic lab inc.","telecom":"michael@ashleylab.com","phone":"","serviceCapabilities":"Drive-in, Walk-in, At-home Sample","prescription":"","sampleCollectionSupervision":"","typeOfSpecimenCollected":"Nasal Mid turbinate Swab Test; Nasopharyngeal Swab Test; Oropharyngeal Swab Test; Saliva Test","typeOfCovidTest":"PCR Molecular Tests","dailyCapacity":"5001-10K tests/day","testTurnaround":"Less than 24 hrs","payorsBilledBy":"Aetna Payors; Anthem Blue Cross Payors; Blue Shield ofCalifornia Payors; Centene Payors; Cigna Payors; Kaiser Permanente Payors; LA Care Payors; Medi-Cal Payors; Medicare FFS Payors; Molina Healthcare Payors; United Healthcare","contractingEntities":"Congregate Living Facilities; Health Plans; Hospitals; Long Term Care Facilities; Outpatient Practices; Private Employers; SFCs","testPerformedByFacility":""},{"labId":9,"longitude":"37.43989","latitude":"-122.18042","updateDate":"19-12-2021","sources":"","country":"USA","state":"CA","county":"San Mateo","city":"Menlo Park","coverageAreas":"All California; Out of State as Well","managingOrganization":"AVELLINO LAB USA INC","telecom":"connie@avellino.com","phone":"","serviceCapabilities":"At-home Test","prescription":"","sampleCollectionSupervision":"","typeOfSpecimenCollected":"Nasopharyngeal Swab Test; Oropharyngeal Swab Test","typeOfCovidTest":"PCR Molecular Tests","dailyCapacity":"","testTurnaround":"Within 48-72 hrs","payorsBilledBy":"Aetna Payors; Anthem Blue Cross Payors; Blue Shield ofCalifornia Payors; Centene Payors; Cigna Payors; Kaiser Permanente Payors; LA Care Payors; Medi-Cal Payors; Medicare FFS Payors; Molina Healthcare Payors; United Healthcare","contractingEntities":"Congregate Living Facilities Health Plans Hospitals Long Term Care Facilities Outpatient Practices Private Employers SFCs","testPerformedByFacility":""},{"labId":10,"longitude":"33.82898","latitude":"-117.92187","updateDate":"","sources":"http://bachdiagnostics.com","country":"USA","state":"CA","county":"Orange","city":"Santa Ana","coverageAreas":"All California","managingOrganization":"BACH MEDICAL GROUP DBA BACH DIAGNOSTICS","telecom":"rick@bachdiagnostics.com","phone":"","serviceCapabilities":"Drive-in, Walk-in, At-home Sample","prescription":"","sampleCollectionSupervision":"","typeOfSpecimenCollected":"Nasal Mid turbinate Swab Test; Nasopharyngeal Swab Test; Serum Test","typeOfCovidTest":"SerologyTests; PCR Molecular Tests","dailyCapacity":"1001-2000 tests/day","testTurnaround":"Within 24-48 hrs","payorsBilledBy":"Aetna Payors; Anthem Blue Cross Payors; Blue Shield ofCalifornia Payors; Centene Payors; Cigna Payors; Kaiser Permanente Payors; LA Care Payors; Medicare FFS Payors; Molina Healthcare Payors; United Healthcare","contractingEntities":"Congregate Living Facilities Health Plans Hospitals Long Term Care Facilities Outpatient Practices Private Employers SFCs","testPerformedByFacility":""},{"labId":11,"longitude":"32.41372","latitude":"-95.38153","updateDate":"","sources":"http://CuurHealth.com","country":"USA","state":"CA","county":"Oos","city":"Las Vegas","coverageAreas":"All California","managingOrganization":"Bandar Enterprises LLC d.b.a. CUUR Diagnostics","telecom":"cdura@cuurhealth.com","phone":""
				
				var all_labs = data.response.labData;
				
				$("#lab-list").html("");
				
				var lastloc_latitude, lastloc_longitude;
				
				for(var i=0;i<all_labs.length;i+=1){
				
					//add it on the left panel
				
					var the_lab = all_labs[i];
					$("#lab-list").append('<div class="row">'+
					'	<div class="col-md-12">'+
					'		<div class="card">'+
					'		  <div class="card-body">'+
					'			<h5 class="card-title">'+the_lab.managingOrganization+'</h5>'+
					'			<p class="card-text">Service Capabilities: '+the_lab.serviceCapabilities+'</p>'+
					'			<p class="card-text">Type of COVID Tests: '+the_lab.typeOfCovidTest+'</p>'+
					'			<p class="card-text">Test Around: '+the_lab.testTurnaround+'</p>'+
					'			<a href="#" class="btn btn-primary">Order Here</a>'+
					'		  </div>'+
					'		</div>'+
					'	</div>'+
					'</div><br/>');
					
					//add it on the map
					L.marker([the_lab.longitude, the_lab.latitude]).addTo(map)
					.bindPopup(the_lab.managingOrganization)
					.openPopup();
					
					lastloc_latitude = the_lab.longitude;
					
					lastloc_longitude = the_lab.latitude;
					
				}
				
				map.panTo(new L.LatLng(lastloc_latitude, lastloc_longitude));
				
				//alert(JSON.stringify(data));
				
			},
			error: function(errMsg) {
				alert(errMsg);
			}
		});
	</script>



</body>
</html>
	

